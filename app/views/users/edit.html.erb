<div class="container">
    <div class="row">
        <div class="col-md-offset-3 col-md-6">
			<% if flash[:warning] %>
			    <p class="alert alert-danger"><%= flash[:warning] %></p>
			<% end %>

			<h1>ユーザ編集</h1>
			<br>
			<br>
			<%= form_with model: @user, local: true  do |f| %>

			  <label>プロフィール画像</label>
			  <%= f.file_field :image, class: "", id: :imgInp %>
			  <output id="list"></output>
			  <br>


			  <label>ユーザ名</label>
			  <%= f.text_field :user_name %><br>
			  <%= f.submit "更新" %>
			<% end %>
			<div class="preview" /></div>
		</div>
	</div>
</div>

<script>
	document.getElementById('imgInp').onchange = function(event) {
	    initializeFiles();

	    var file = event.target.files[0],
	    	reader = new FileReader();
	        reader.readAsDataURL(file);

	        reader.onload = (function(file) {
	            return function(e) {
	                var div = document.createElement('div');
	                div.className = 'reader_file';
	                div.innerHTML += '<img class="reader_image" src="' + e.target.result + '" width="150px" />';
	                document.getElementById('list').insertBefore(div, null);
	            };
	        })(file);
	    };

	function initializeFiles() {
	    document.getElementById('list').innerHTML = '';
	};
</script>